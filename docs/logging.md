# Logging Strategy

This document outlines the logging strategy implemented in the `downloads-server` project, detailing how logs are generated, configured, and utilized for monitoring and troubleshooting.

## Purpose of Logging

Logging is a critical component for understanding the behavior of the `downloads-server` in various environments. It serves several key purposes:

- **Monitoring:** Provides real-time insights into the application's operations and health.
- **Troubleshooting:** Helps in diagnosing issues, identifying root causes of errors, and debugging unexpected behavior.
- **Auditing:** Records significant events for security and compliance purposes.
- **Performance Analysis:** Captures data that can be used to analyze and optimize application performance.

## Logging Library

The `downloads-server` utilizes **Winston**, a versatile and robust logging library for Node.js. Winston allows for flexible configuration of log levels, transports (where logs are sent), and formatting.

## Log Levels

The application uses standard log levels to categorize messages by their severity. The default logging level is `info`, meaning messages with `info` severity and higher (e.g., `warn`, `error`) will be captured.

- **`error`**: Critical errors that prevent the application from functioning correctly.
- **`warn`**: Potentially harmful situations or unexpected events that are not errors.
- **`info`**: General operational messages, indicating normal application flow.
- **`debug`**: Detailed information, typically of interest only when diagnosing problems.

## Log Transports and Output

Logs generated by the application are directed to the following destinations:

1.  **Console Output:**

    - All log messages (info level and above) are displayed in the console.
    - Console output is colorized for better readability and includes timestamps and metadata.
    - This transport is primarily useful for development and real-time monitoring in a terminal.

2.  **Combined Log File (`combined.log`):**
    - All log messages (info level and above) are written to a file named `combined.log` in the project's root directory.
    - Logs in this file are formatted as JSON, making them easy to parse by log analysis tools.
    - This transport is suitable for persistent storage of all application logs.

## Configuration

The logger is configured in `src/utils/logger.ts`. The configuration defines the log levels, formats, and transports. Currently, the logging level is set to `info`.

## Best Practices for Logging

- **Contextual Information:** Always include relevant contextual information in log messages (e.g., `downloadId`, `volumeName`, error details) to aid in troubleshooting.
- **Appropriate Log Levels:** Use the correct log level for each message to ensure proper categorization and filtering.
- **Avoid Sensitive Data:** Never log sensitive information such as passwords, API keys, or personal user data.
- **Structured Logging:** Leverage JSON formatting for file logs to enable easier parsing and analysis by automated tools.
- **Minimal Logging in Tests:** unit tests **MUST** mock the logger module with an empty implementation to avoid testing logging behavior and to keep tests focused on core logic.
